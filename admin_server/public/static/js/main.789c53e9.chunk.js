(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1236:function(e,t,a){},1237:function(e,t,a){},1238:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),i=a(17),l=a(18),s=a(20),u=a(19),m=a(21),p=a(113),d=a(127),h=(a(78),a(29)),f=(a(130),a(38)),y=(a(97),a(46)),g=(a(116),a(8)),b=a(22),v=a.n(b),E=a(33),O=a(84),k=(a(104),a(36)),w=a(526),j=a(527),x=a.n(j),C=a(345),S=a.n(C);function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise(function(n,r){("GET"===a?S.a.get(e,{params:t},a):S.a.post(e,t,a)).then(function(e){n(e.data)}).catch(function(e){k.a.error("\u8bf7\u6c42\u5931\u8d25\u4e86"+e.message)})})}var I=function(e,t){return N("/login",{username:e,password:t},"POST")},_=function(e){return N("/manage/user/"+(e._id?"update":"add"),e,"POST")},T=function(e){return N("/manage/user/delete",{userId:e},"POST")},P=function(){return N("/manage/user/list")},A=function(e){return N("/manage/category/list",{parentId:e})},M=function(e){return N("/manage/category/add",{categoryName:e.categoryName,parentId:e.parentId},"POST")},V=function(e){return N("/manage/category/update",{categoryId:e.categoryId,categoryName:e.categoryName},"POST")},D=function(e,t){return N("/manage/product/list",{pageNum:e,pageSize:t})},U=function(e){var t=e.pageNum,a=e.pageSize,n=e.searchType,r=e.searchName;return N("/manage/product/search",Object(w.a)({pageNum:t,pageSize:a},n,r))},F=function(e){return N("/manage/product/"+(e._id?"update":"add"),e,"POST")},L=function(e){return N("/manage/category/info",{categoryId:e})},R=function(e,t){return N("/manage/product/updateStatus",{productId:e,status:t},"POSt")},W=function(e){return N("/manage/img/delete",{name:e},"POST")},z=function(){return N("/manage/role/list")},q=function(e){return N("/manage/role/add",{roleName:e},"POST")},K=function(e){return N("/manage/role/update",e,"POST")},Y=function(e){return new Promise(function(t,a){var n="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");x()(n,{},function(e,a){if(e||"success"!==a.status)k.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25!");else{var n=a.results[0].weather_data[0],r=n.dayPictureUrl,c=n.weather;t({dayPictureUrl:r,weather:c})}})})},B=a(264),J=a.n(B),H=function(e){J.a.set("user_key",e)},G=function(){return J.a.get("user_key")||{}},$=function(){J.a.remove("user_key")},Q=function(e){return{type:"get_user",user:e}},X=function(){return $(),{type:"reset_user"}},Z=(a(631),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(E.a)(v.a.mark(function e(t,n){var r,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t?console.log(t):(r=n.username,c=n.password,a.props.login(r,c));case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.user;if(e&&e._id)return r.a.createElement(d.a,{to:"/home"});var t=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"main"},r.a.createElement("header",{className:"header"},r.a.createElement("h1",null,"\u540e\u53f0\u767b\u5f55\u7cfb\u7edf")),r.a.createElement("div",{className:"container"},r.a.createElement("section",{className:"login-container"},r.a.createElement("h2",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(f.a.Item,null,t("username",{rules:[{required:!0,whiteSpace:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c11\u4e3a4\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u662f\u5b57\u6bcd\uff0c\u6570\u5b57\u4e0b\u5212\u7ebf\u7ec4\u6210"}],initialValue:"admin"})(r.a.createElement(y.a,{prefix:r.a.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),r.a.createElement(f.a.Item,null,t("password",{rules:[{required:!0,whiteSpace:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"},{min:5,message:"\u5bc6\u7801\u81f3\u5c11\u4e3a\u4e94\u4f4d"},{max:12,message:"\u5bc6\u7801\u6700\u591a12\u4f4d"}]})(r.a.createElement(y.a,{prefix:r.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),r.a.createElement(f.a.Item,null,r.a.createElement(h.a,{type:"primary",htmlType:"submit",className:"login-form-button btn"},"Log in"))))))}}]),t}(n.Component)),ee=f.a.create({name:"login"})(Z),te=Object(O.b)(function(e){return{user:e.user}},{login:function(e,t){return function(){var a=Object(E.a)(v.a.mark(function a(n){var r,c,o;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,I(e,t);case 2:0===(r=a.sent).status?(c=r.data,H(c),n(Q(c))):(o=r.msg,k.a.error(o));case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}})(ee),ae=(a(713),a(179)),ne=(a(715),a(154)),re=[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]}],ce=(a(718),ne.b.SubMenu),oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).hasAuth=function(e){var t=e.isPublic,n=e.key,r=a.props.user.role.menus;return!("admin"!==a.props.user.username&&!t&&-1===r.indexOf(n))||!!e.children&&!!e.children.find(function(e){return-1!==r.indexOf(e.key)})},a.getMenuNodes=function(e){var t=a.props.location.pathname;return e.map(function(e){if(a.hasAuth(e))return e.children?(e.children.find(function(e){return 0===t.indexOf(e.key)})&&(a.openKey=e.key),r.a.createElement(ce,{key:e.key,title:r.a.createElement("span",null,r.a.createElement(g.a,{type:e.icon}),r.a.createElement("span",null,e.title))},a.getMenuNodes(e.children))):(e.key!==t&&0!==t.indexOf(e.key)||a.props.setHeaderTitle(e.title),r.a.createElement(ne.b.Item,{key:e.key},r.a.createElement(p.b,{to:e.key,onClick:function(){return a.props.setHeaderTitle(e.title)}},r.a.createElement(g.a,{type:e.icon}),r.a.createElement("span",null,e.title))))})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(re)}},{key:"render",value:function(){var e=this.props.location.pathname;0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return r.a.createElement("div",{className:"left-container"},r.a.createElement(p.b,{to:"/"},r.a.createElement("div",{className:"left-logo"})),r.a.createElement(ne.b,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[t]},this.menuNodes))}}]),t}(n.Component),ie=Object(O.b)(function(e){return{user:e.user}},{setHeaderTitle:function(e){return{type:"set_header_title",data:e}}})(Object(d.g)(oe)),le=(a(189),a(74));a(728);function se(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))}function ue(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}a(729);var me=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentTime:ue(Date.now()),dayPictureUrl:"",weather:""},a.getTime=function(){a.intervalId=setInterval(function(){var e=ue(Date.now());a.setState({currentTime:e})},1e3)},a.getWeather=Object(E.a)(v.a.mark(function e(){var t,n,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y("\u5317\u4eac");case 2:t=e.sent,n=t.dayPictureUrl,r=t.weather,a.setState({dayPictureUrl:n,weather:r});case 6:case"end":return e.stop()}},e)})),a.logout=function(){le.a.confirm({content:"\u786e\u5b9a\u9000\u51fa\u5417?",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){a.props.logout()}})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,a=e.dayPictureUrl,n=e.weather,c=this.props.user.username,o=this.props.headerTitle;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-top"},r.a.createElement("span",null,"\u6b22\u8fce, ",c),r.a.createElement(se,{onClick:this.logout},"\u9000\u51fa")),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("div",{className:"header-bottom-left"},o),r.a.createElement("div",{className:"header-bottom-right"},r.a.createElement("span",null,t),r.a.createElement("img",{src:a,alt:"weather"}),r.a.createElement("span",null,n))))}}]),t}(n.Component),pe=Object(O.b)(function(e){return{headerTitle:e.headerTitle,user:e.user}},{logout:X})(Object(d.g)(me)),de=(a(730),a(180)),he=(a(102),a(42)),fe=(a(734),a(266)),ye=(a(1239),a(546)),ge=a(25),be=a.n(ge),ve=a(69),Ee=a(533),Oe=a.n(Ee),ke=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=(new Oe.a).createView().source([{month:"Jan",a:7,b:3.9,c:5.9},{month:"Feb",a:6.9,b:4.2,c:1.9},{month:"Mar",a:9.5,b:5.7,c:3.9},{month:"Apr",a:14.5,b:8.5,c:5.5},{month:"May",a:18.4,b:11.9,c:8.9},{month:"Jun",a:21.5,b:15.2,c:10},{month:"Jul",a:25.2,b:17,c:12.9},{month:"Aug",a:26.5,b:16.6,c:15.9},{month:"Sep",a:23.3,b:14.2,c:20.7},{month:"Oct",a:18.3,b:10.3,c:25.9},{month:"Nov",a:13.9,b:6.6,c:30.9},{month:"Dec",a:9.6,b:4.8,c:35.9}]);e.transform({type:"fold",fields:["a","b","c"],key:"city",value:"temperature"});return r.a.createElement("div",{style:{float:"right",width:750,height:300}},r.a.createElement(ve.Chart,{height:250,data:e,scale:{month:{range:[0,1]}},forceFit:!0},r.a.createElement(ve.Legend,null),r.a.createElement(ve.Axis,{name:"month"}),r.a.createElement(ve.Axis,{name:"temperature",label:{formatter:function(e){return"".concat(e,"\u4e07\u4e2a")}}}),r.a.createElement(ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(ve.Geom,{type:"line",position:"month*temperature",size:2,color:"city",shape:"smooth"}),r.a.createElement(ve.Geom,{type:"point",position:"month*temperature",size:4,shape:"circle",color:"city",style:{stroke:"#fff",lineWidth:1}})))}}]),t}(r.a.Component),we=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",marginLeft:-30}},r.a.createElement(ve.Chart,{height:338,data:[{year:"1\u6708",sales:38},{year:"2\u6708",sales:52},{year:"3\u6708",sales:61},{year:"4\u6708",sales:145},{year:"5\u6708",sales:48},{year:"6\u6708",sales:38},{year:"7\u6708",sales:28},{year:"8\u6708",sales:38},{year:"59\u6708",sales:68},{year:"10\u6708",sales:38},{year:"11\u6708",sales:58},{year:"12\u6708",sales:38}],scale:{sales:{tickInterval:20}},forceFit:!0},r.a.createElement(ve.Axis,{name:"year"}),r.a.createElement(ve.Axis,{name:"sales"}),r.a.createElement(ve.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(ve.Geom,{type:"interval",position:"year*sales"})))}}]),t}(r.a.Component),je=(a(739),ye.a.RangePicker),xe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isVisited:!0},a.handleChange=function(e){return function(){return a.setState({isVisited:e})}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.isVisited;return r.a.createElement("div",{className:"home"},r.a.createElement(he.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:r.a.createElement(g.a,{style:{color:"rgba(0,0,0,.45)"},type:"question-circle"}),style:{width:250},headStyle:{color:"rgba(0,0,0,.45)"}},r.a.createElement(fe.a,{value:1128163,suffix:"\u4e2a",style:{fontWeight:"bolder"}}),r.a.createElement(fe.a,{value:15,valueStyle:{fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(g.a,{style:{color:"red",marginLeft:10},type:"arrow-down"}))}),r.a.createElement(fe.a,{value:10,valueStyle:{fontSize:15},prefix:"\u65e5\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(g.a,{style:{color:"#3f8600",marginLeft:10},type:"arrow-up"}))})),r.a.createElement(ke,null),r.a.createElement(he.a,{className:"home-content",title:r.a.createElement("div",{className:"home-menu"},r.a.createElement("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0)},"\u8bbf\u95ee\u91cf"),r.a.createElement("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1)},"\u9500\u552e\u91cf")),extra:r.a.createElement(je,{defaultValue:[be()("2019/01/01","YYYY/MM/DD"),be()("2019/06/01","YYYY/MM/DD")],format:"YYYY/MM/DD"})},r.a.createElement(he.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0,height:275},extra:r.a.createElement(g.a,{type:"reload"})},r.a.createElement(we,null)),r.a.createElement(he.a,{title:"\u4efb\u52a1",extra:r.a.createElement(g.a,{type:"reload"}),className:"home-table-right"},r.a.createElement(de.a,null,r.a.createElement(de.a.Item,{color:"green"},"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"),r.a.createElement(de.a.Item,{color:"green"},"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"),r.a.createElement(de.a.Item,{color:"red"},r.a.createElement("p",null,"\u8054\u8c03\u63a5\u53e3"),r.a.createElement("p",null,"\u529f\u80fd\u9a8c\u6536")),r.a.createElement(de.a.Item,null,r.a.createElement("p",null,"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"),r.a.createElement("p",null,"\u6743\u9650\u9a8c\u8bc1"),r.a.createElement("p",null,"\u9875\u9762\u6392\u7248"))))))}}]),t}(n.Component),Ce=(a(250),a(123)),Se=(a(399),a(178)),Ne=(a(226),a(68)),Ie=f.a.Item,_e=Ne.a.Option,Te=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props,t=e.category,a=e.parentId,n=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(Ie,{label:"\u5206\u7c7b\u5217\u8868"},n("parentId",{initialValue:a})(r.a.createElement(Ne.a,null,r.a.createElement(_e,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),t.map(function(e){return r.a.createElement(_e,{value:e._id,key:e._id},e.name)})))),r.a.createElement(Ie,{label:"\u5206\u7c7b\u540d\u79f0"},n("categoryName")(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Pe=f.a.create({})(Te),Ae=f.a.Item,Me=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.categoryName,t=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(Ae,{label:"\u5206\u7c7b\u540d\u79f0"},t("categoryName",{initialValue:e})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component),Ve=f.a.create()(Me),De=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={category:[],subCategorys:[],loading:!1,parentId:"0",parentName:"",status:0},a.initColumn=function(){a.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u64cd\u4f5c",key:"action",width:400,render:function(e){return r.a.createElement("span",null,r.a.createElement(se,{onClick:function(){a.update(e)}},"\u4fee\u6539\u5206\u7c7b"),"0"===a.state.parentId?r.a.createElement("span",null,r.a.createElement(Se.a,{type:"vertical"}),r.a.createElement(se,{onClick:function(){a.showSubCategory(e)}},"\u67e5\u770b\u5b50\u5206\u7c7b")):null)}}]},a.getCategory=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=t||a.state.parentId,e.next=4,A(t);case 4:0===(n=e.sent).status?(a.setState({loading:!1}),r=n.data,console.log(r),"0"===t?a.setState({category:r}):a.setState({subCategorys:r})):k.a.error("\u83b7\u53d6\u5206\u7c7b\u4fe1\u606f\u5931\u8d25");case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.showSubCategory=function(e){a.setState({parentId:e._id,parentName:e.name},function(){a.getCategory()})},a.showCategory=function(){a.setState({parentId:"0",parentName:"",subCategorys:[]})},a.handleCancel=function(){a.setState({status:0})},a.add=function(){a.setState({status:1})},a.addCategory=Object(E.a)(v.a.mark(function e(){var t,n,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.handleCancel(),t=a.form.getFieldsValue(),n=t.parentId,r=t.categoryName,e.next=4,M({categoryName:r,parentId:n});case 4:0===e.sent.status&&(k.a.success("\u6dfb\u52a0\u5206\u985e\u6210\u529f"),a.getCategory());case 6:case"end":return e.stop()}},e)})),a.update=function(e){a.categoryName=e,a.setState({status:2})},a.updateCategory=Object(E.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.handleCancel(),t=a.categoryName._id,n=a.form.getFieldValue("categoryName"),e.next=5,V({categoryId:t,categoryName:n});case 5:0===e.sent.status&&(k.a.success("\u66f4\u65b0\u5206\u985e\u6210\u529f"),a.getCategory());case 7:case"end":return e.stop()}},e)})),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.initColumn()}},{key:"componentDidMount",value:function(){this.getCategory()}},{key:"render",value:function(){var e=this,t=this.state,a=t.category,n=t.loading,c=t.subCategorys,o=t.parentId,i=t.parentName,l=t.status,s=this.categoryName||{},u="0"===o?"\u4e00\u7ea7\u5206\u7c7b":r.a.createElement("span",null,r.a.createElement(se,{onClick:this.showCategory},"\u4e00\u7ea7\u5206\u7c7b"),r.a.createElement(Se.a,{type:"vertical"}),r.a.createElement("span",null,i)),m=r.a.createElement(h.a,{type:"primary",onClick:this.add},r.a.createElement(g.a,{type:"plus"}),"\u6dfb\u52a0\u5206\u7c7b");return r.a.createElement(he.a,{title:u,extra:m},r.a.createElement(Ce.a,{dataSource:"0"===o?a:c,columns:this.columns,bordered:!0,loading:n,pagination:{defaultPageSize:5,showQuickJumper:!0},rowKey:"_id"}),l&&r.a.createElement(le.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===l,onOk:this.addCategory,onCancel:this.handleCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement(Pe,{category:a,parentId:o,setForm:function(t){return e.form=t}})),l&&r.a.createElement(le.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===l,onOk:this.updateCategory,onCancel:this.handleCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement(Ve,{categoryName:s.name,setForm:function(t){e.form=t}})))}}]),t}(n.Component),Ue=3,Fe="http://localhost:5000/upload/",Le={product:{}},Re=Ne.a.Option,We=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={products:[],total:0,loading:!1,searchName:"",searchType:"productName"},a.initColumns=function(){a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\xa5"+e}},{width:200,title:"\u72b6\u6001",render:function(e){var t=e.status,n=e._id,c=1===t?2:1;return r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",onClick:function(){a.updateStatus(n,c)}},1===t?"\u4e0b\u67b6":"\u4e0a\u67b6"),r.a.createElement(Se.a,{type:"vertical"}),r.a.createElement("span",null,1===t?"\u5728\u552e":"\u5df2\u4e0b\u67b6"))}},{width:150,title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(se,{onClick:function(){return a.showDetails(e)}},"\u8be6\u60c5"),r.a.createElement(Se.a,{type:"vertical"}),r.a.createElement(se,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539"))}}]},a.showDetails=function(e){Le.product=e,a.props.history.push("/product/details")},a.showUpdate=function(e){Le.product=e,a.props.history.push("/product/add")},a.getProducts=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r,c,o,i,l,s;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.pageNum=t,a.setState({loading:!0}),r=a.state,c=r.searchName,o=r.searchType,!c){e.next=9;break}return e.next=6,U({pageNum:t,pageSize:Ue,searchType:o,searchName:c});case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,D(t,Ue);case 11:n=e.sent;case 12:0===n.status&&(i=n.data,l=i.list,s=i.total,a.setState({products:l,total:s,loading:!1}));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.updateStatus=function(){var e=Object(E.a)(v.a.mark(function e(t,n){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t,n);case 2:0===e.sent.status&&(k.a.success("\u5546\u54c1\u72b6\u6001\u66f4\u65b0\u6210\u529f"),a.getProducts(a.pageNum));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts()}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,c=t.loading,o=t.searchType,i=t.searchName,l=r.a.createElement("span",null,r.a.createElement(Ne.a,{value:o,onChange:function(t){e.setState({searchType:t})}},r.a.createElement(Re,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(Re,{value:"productDesc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(y.a,{placeholder:"\u5173\u952e\u5b57",style:{width:300,margin:"0 10px"},value:i,onChange:function(t){e.setState({searchName:t.target.value})}}),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.getProducts(1)}},r.a.createElement(g.a,{type:"search"}),"\u641c\u7d22")),s=r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.history.push("/product/add")}},r.a.createElement(g.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement(he.a,{title:l,extra:s},r.a.createElement(Ce.a,{dataSource:a,columns:this.columns,bordered:!0,pagination:{current:this.pageNum,total:n,defaultPageSize:Ue,showQuickJumper:!0,onChange:this.getProducts},rowKey:"_id",loading:c}))}}]),t}(n.Component),ze=(a(797),a(548)),qe=a(263),Ke=a(170),Ye=(a(1240),a(547));function Be(e){return new Promise(function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}})}var Je=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(E.a)(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Be(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r,c,o,i,l;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,"done"!==n.status){e.next=6;break}0===(c=n.response).status?(k.a.success("\u56fe\u7247\u4e0a\u4f20\u6210\u529f"),o=c.data,i=o.name,l=o.url,(n=r[r.length-1]).name=i,n.url=l):k.a.error("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25"),e.next=11;break;case 6:if("removed"!==n.status){e.next=11;break}return e.next=9,W(n.name);case 9:0===e.sent.status?k.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f"):k.a.error("\u5220\u9664\u56fe\u7247\u5931\u8d25");case 11:a.setState({fileList:r});case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getImgs=function(){return a.state.fileList.map(function(e){return e.name})};var n=a.props.imgs,r=[];return n&&n.length>0&&(r=n.map(function(e,t){return{uid:-t,name:e,url:Fe+e,status:"done"}})),a.state={previewVisible:!1,previewImage:"",fileList:r},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,c=r.a.createElement("div",null,r.a.createElement(g.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload"));return r.a.createElement("div",{className:"clearfix"},r.a.createElement(Ye.a,{accept:"image/*",name:"image",action:"/manage/img/upload",listType:"picture-card",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange},n.length>=4?null:c),r.a.createElement(le.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(n.Component),He=a(151),Ge=a(541),$e=a(542),Qe=a.n($e),Xe=a(543),Ze=a.n(Xe),et=(a(924),function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onEditorStateChange=function(e){a.setState({editorState:e})},a.getDetail=function(){return Qe()(Object(He.convertToRaw)(a.state.editorState.getCurrentContent()))},a.uploadImageCallBack=function(e){return new Promise(function(t,a){var n=new XMLHttpRequest;n.open("POST","/manage/img/upload");var r=new FormData;r.append("image",e),n.send(r),n.addEventListener("load",function(){var e=JSON.parse(n.responseText).data.url;t({data:{link:e}})}),n.addEventListener("error",function(){var e=JSON.parse(n.responseText);a(e)})})};var n=a.props.detail;if(n){var r=Ze()(n);if(r){var c=He.ContentState.createFromBlockArray(r.contentBlocks),o=He.EditorState.createWithContent(c);a.state={editorState:o}}}else a.state={editorState:He.EditorState.createEmpty()};return a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement(Ge.Editor,{editorStyle:{border:"1px solid #000",minHeight:300,paddingLeft:10},editorState:e,onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})}}]),t}(n.Component)),tt=f.a.Item,at=y.a.TextArea,nt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={options:[]},a.validatorPrice=function(e,t,a){1*t>0?a():a("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0")},a.submit=function(){a.props.form.validateFields(function(){var e=Object(E.a)(v.a.mark(function e(t,n){var r,c,o,i,l,s,u,m,p;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}return r=n.name,c=n.desc,o=n.price,1===(i=n.categoryIds).length?(l="0",s=i[0]):(l=i[0],s=i[1]),u=a.pw.current.getImgs(),m=a.ed.current.getDetail(),p={name:r,desc:c,price:o,imgs:u,detail:m,pCategoryId:l,categoryId:s},a.isUpdate&&(p._id=a.product._id),e.next=9,F(p);case 9:0===e.sent.status?(k.a.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f!")),a.props.history.goBack()):k.a.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25!"));case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.initOptions=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r,c,o,i,l,s;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map(function(e){return{value:e._id,label:e.name,isLeaf:!1}}),r=Object(Ke.a)(a),c=r.isUpdate,o=r.product,i=o.pCategoryId,!c||"0"===i){e.next=10;break}return e.next=6,a.getCategory(i);case 6:l=e.sent,s=l.map(function(e){return{value:e._id,label:e.name,isLeaf:!0}}),n.find(function(e){return e.value===i}).children=s;case 10:a.setState({options:n});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getCategory=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(r=n.data,"0"!==t){e.next=9;break}a.initOptions(r),e.next=10;break;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(E.a)(v.a.mark(function e(t){var n,r,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategory(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(c=r.map(function(e){return{value:e._id,label:e.name,isLeaf:!0}}),n.children=c):n.isLeaf=!0,a.setState({options:Object(qe.a)(a.state.options)});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.pw=r.a.createRef(),a.ed=r.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=Le.product;this.isUpdate=!!e._id,this.product=e||{}}},{key:"componentDidMount",value:function(){this.getCategory("0")}},{key:"componentWillUnmount",value:function(){Le.product={}}},{key:"render",value:function(){var e=this,t=this.isUpdate,a=this.product,n=[],c=a.pCategoryId,o=a.categoryId,i=a.imgs,l=a.detail;"0"===c?n.push(o):(n.push(c),n.push(o));var s=r.a.createElement("span",null,r.a.createElement(se,{onClick:function(){return e.props.history.goBack()}},r.a.createElement(g.a,{type:"arrow-left"})),r.a.createElement("span",null,t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1")),u=this.props.form.getFieldDecorator;return r.a.createElement(he.a,{title:s},r.a.createElement(f.a,{labelCol:{span:2},wrapperCol:{span:8}},r.a.createElement(tt,{label:"\u5546\u54c1\u540d\u79f0"},u("name",{initialValue:a.name,rules:[{required:!0,message:"\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(tt,{label:"\u5546\u54c1\u63cf\u8ff0"},u("desc",{initialValue:a.desc,rules:[{required:!0,message:"\u63cf\u8ff0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(at,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autosize:{minRows:2,maxRows:6}}))),r.a.createElement(tt,{label:"\u5546\u54c1\u4ef7\u683c"},u("price",{initialValue:a.price,rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u4ef7\u683c"},{validator:this.validatorPrice}]})(r.a.createElement(y.a,{type:"number",addonAfter:"\u5143",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c"}))),r.a.createElement(tt,{label:"\u5546\u54c1\u5206\u7c7b"},u("categoryIds",{initialValue:[],rules:[{required:!0,message:"\u5fc5\u987b\u6307\u5b9a\u5206\u7c7b"}]})(r.a.createElement(ze.a,{options:this.state.options,loadData:this.loadData,changeOnSelect:!0}))),r.a.createElement(tt,{label:"\u5546\u54c1\u56fe\u7247"},r.a.createElement(Je,{ref:this.pw,imgs:i})),r.a.createElement(tt,{label:"\u5546\u54c1\u8be6\u60c5",labelCol:{span:2},wrapperCol:{span:20}},r.a.createElement(et,{ref:this.ed,detail:l})),r.a.createElement(h.a,{type:"primary",onClick:this.submit},"\u6dfb\u52a0\u5546\u54c1")))}}]),t}(n.PureComponent),rt=f.a.create()(nt),ct=(a(925),a(350)),ot=ct.a.Item,it=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={cName1:"",cName2:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(E.a)(v.a.mark(function e(){var t,a,n,r,c,o,i,l;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Le.product,a=t.pCategoryId,n=t.categoryId,"0"!==a){e.next=8;break}return e.next=4,L(n);case 4:0===(r=e.sent).status&&(c=r.data.name,this.setState({cName1:c})),e.next=12;break;case 8:return e.next=10,Promise.all([L(a),L(n)]);case 10:0===(o=e.sent).status&&(i=o[0].data.name,l=o[1].data.name,this.setState({cName1:i,cName2:l}));case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){Le.product={}}},{key:"render",value:function(){var e=this,t=Le.product,a=t.name,n=t.desc,c=t.price,o=t.detail,i=t.imgs,l=t.cName1,s=t.cName2,u=r.a.createElement("span",null,r.a.createElement(se,null,r.a.createElement(g.a,{type:"arrow-left",onClick:function(){return e.props.history.goBack()}})),r.a.createElement("span",null,"\u5546\u54c1\u8be6\u60c5"));return r.a.createElement(he.a,{title:u,className:"details-container"},r.a.createElement(ct.a,null,r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u5546\u54c1\u540d\u79f0:"),r.a.createElement("span",{className:"details-desc"},a)),r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u5546\u54c1\u63cf\u8ff0:"),r.a.createElement("span",{className:"details-desc"},n)),r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u5546\u54c1\u4ef7\u683c:"),r.a.createElement("span",{className:"details-desc"},c,"\u5143")),r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u6240\u5c5e\u5206\u7c7b:"),r.a.createElement("span",{className:"details-desc"},l,s?"--\x3e"+s:"")),r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u5546\u54c1\u56fe\u7247:"),r.a.createElement("span",{className:"details-desc"},i.map(function(e){return r.a.createElement("img",{className:"details-img",key:e,src:Fe+e,alt:"img desc"})}))),r.a.createElement(ot,null,r.a.createElement("span",{className:"details-name"},"\u5546\u54c1\u8be6\u60c5:"),r.a.createElement("span",{dangerouslySetInnerHTML:{__html:o}}))))}}]),t}(n.Component),lt=(a(927),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/product",component:We}),r.a.createElement(d.b,{exact:!0,path:"/product/add",component:rt}),r.a.createElement(d.b,{exact:!0,path:"/product/details",component:it}),r.a.createElement(d.a,{to:"/product"}))}}]),t}(n.Component)),st=f.a.Item,ut=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(st,{label:"\u89d2\u8272\u540d\u79f0",labelCol:{span:4},wrapperCol:{span:20}},e("roleName",{initialValue:"",rules:[{required:!0,message:"\u89d2\u8272\u540d\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"}))))}}]),t}(n.Component),mt=f.a.create({})(ut),pt=(a(928),a(349)),dt=f.a.Item,ht=pt.a.TreeNode,ft=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onCheck=function(e){a.setState({checkedKeys:e})},a.getTreeNode=function(e){return e.map(function(e){return r.a.createElement(ht,{title:e.title,key:e.key},e.children?a.getTreeNode(e.children):null)})},a.getMenus=function(){return a.state.checkedKeys};var n=a.props.role.menus;return a.state={checkedKeys:n},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.treeNode=this.getTreeNode(re)}},{key:"render",value:function(){var e=this.props.role,t=this.state.checkedKeys;return r.a.createElement("div",null,r.a.createElement(dt,{label:"\u89d2\u8272\u540d\u79f0",labelCol:{span:4},wrapperCol:{span:20}},r.a.createElement(y.a,{value:e.name,disabled:!0})),r.a.createElement(pt.a,{defaultExpandAll:!0,checkable:!0,checkedKeys:t,onCheck:this.onCheck},r.a.createElement(ht,{title:"\u5e73\u53f0\u6743\u9650",key:"0-0"},this.treeNode)))}}]),t}(n.PureComponent),yt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).initColumns=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:ue},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:ue},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.onRow=function(e){return{onClick:function(t){a.setState({role:e})}}},a.getRoleList=Object(E.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:0===(t=e.sent).status&&(n=t.data,a.setState({roles:n}));case 4:case"end":return e.stop()}},e)})),a.addRoles=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark(function e(t,n){var r,c,o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return r=n.roleName,e.next=4,q(r);case 4:0===(c=e.sent).status?(k.a.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),o=c.data,a.setState(function(e){return{roles:[].concat(Object(qe.a)(e.roles),[o])}}),a.setState({isShowAdd:!1})):k.a.error("\u89d2\u8272\u521b\u5efa\u5931\u8d25");case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.authRole=Object(E.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.role,n=a.auth.current.getMenus(),t.menus=n,t.auth_name=a.props.user.username,e.next=6,K(t);case 6:0===e.sent.status?(a.setState({isShowAuth:!1}),t._id===a.props.user.role_id?(k.a.info("\u60a8\u5df2\u4fee\u6539\u4e86\u6743\u9650\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),a.props.logout()):(k.a.success("\u6388\u6743\u6210\u529f"),a.getRoleList())):k.a.error("\u6388\u6743\u5931\u8d25");case 8:case"end":return e.stop()}},e)})),a.state={roles:[],role:{},isShowAdd:!1,isShowAuth:!1},a.auth=r.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getRoleList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.role,c=t.isShowAdd,o=t.isShowAuth,i=r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",style:{marginRight:10},onClick:function(){return e.setState({isShowAdd:!0})}},"\u521b\u5efa\u89d2\u8272"),r.a.createElement(h.a,{type:"primary",disabled:!n._id,onClick:function(){return e.setState({isShowAuth:!0})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"));return r.a.createElement(he.a,{title:i},r.a.createElement(Ce.a,{dataSource:a,columns:this.columns,onRow:this.onRow,bordered:!0,pagination:{defaultPageSize:Ue,showQuickJumper:!0},rowKey:"_id",rowSelection:{type:"Radio",selectedRowKeys:[n._id],onSelect:function(t){e.setState({role:t})}}}),c&&r.a.createElement(le.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:c,onOk:this.addRoles,onCancel:function(){return e.setState({isShowAdd:!1})},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement(mt,{setForm:function(t){return e.form=t}})),o&&r.a.createElement(le.a,{title:"\u6743\u9650\u7ba1\u7406",visible:o,onOk:this.authRole,onCancel:function(){return e.setState({isShowAuth:!1})},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},r.a.createElement(ft,{role:n,ref:this.auth})))}}]),t}(n.Component),gt=Object(O.b)(function(e){return{user:e.user}},{logout:X})(yt),bt=f.a.Item,vt=Ne.a.Option,Et=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).phoneValidate=function(e,t,a){/^1((3[\d])|(4[5,6,9])|(5[0-3,5-9])|(6[5-7])|(7[0-8])|(8[1-3,5-8])|(9[1,8,9]))\d{8}$/.test(t)?a():a("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801")},a.emailValidate=function(e,t,a){/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(t)?a():a("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u683c\u5f0f")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.roles,a=this.props.user||{};return r.a.createElement(f.a,{labelCol:{span:4},wrapperCol:{span:20}},r.a.createElement(bt,{label:"\u7528\u6237\u540d"},e("username",{initialValue:a.username,rules:[{required:!0,whiteSpace:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c11\u4e3a4\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u662f\u5b57\u6bcd\uff0c\u6570\u5b57\u4e0b\u5212\u7ebf\u7ec4\u6210"}]})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}))),a._id?null:r.a.createElement(bt,{label:"\u5bc6\u7801"},e("password",{initialValue:a.password,rules:[{required:!0,whiteSpace:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"},{min:5,message:"\u5bc6\u7801\u81f3\u5c11\u4e3a\u4e94\u4f4d"},{max:12,message:"\u5bc6\u7801\u6700\u591a12\u4f4d"}]})(r.a.createElement(y.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(bt,{label:"\u624b\u673a\u53f7\u7801"},e("phone",{initialValue:a.phone,rules:[{required:!0,message:"\u624b\u673a\u53f7\u7801\u5fc5\u987b\u586b\u5199"},{validator:this.phoneValidate}]})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"}))),r.a.createElement(bt,{label:"\u90ae\u7bb1"},e("email",{initialValue:a.email,rules:[{required:!0,message:"\u90ae\u7bb1\u5fc5\u987b\u586b\u5199"},{validator:this.emailValidate}]})(r.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(bt,{label:"\u89d2\u8272"},e("role_id",{initialValue:a.role_id,rules:[{required:!0,message:"\u89d2\u8272\u8bf7\u9009\u8005"}]})(r.a.createElement(Ne.a,null,t.map(function(e){return r.a.createElement(vt,{value:e._id,key:e._id},e.name)})))))}}]),t}(n.PureComponent),Ot=f.a.create()(Et),kt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).initColumns=function(){a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:ue},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.roleNames[e]}},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(se,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539"),r.a.createElement(se,{onClick:function(){return a.deleteUser(e)}},"\u5220\u9664"))}}]},a.initRoleNames=function(e){var t=e.reduce(function(e,t){return e[t._id]=t.name,e},{});a.roleNames=t},a.getUserList=Object(E.a)(v.a.mark(function e(){var t,n,r,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:0===(t=e.sent).status&&(n=t.data,r=n.users,c=n.roles,a.initRoleNames(c),a.setState({users:r,roles:c}));case 4:case"end":return e.stop()}},e)})),a.addOrUpdateUser=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark(function e(t,n){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return a.setState({isShow:!1}),r=a.form.getFieldsValue(),a.user&&a.user._id&&(r._id=a.user._id),e.next=6,_(r);case 6:0===e.sent.status&&(k.a.success("".concat(a.user?"\u66f4\u65b0":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f")),a.getUserList());case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.showUpdate=function(e){a.user=e,a.setState({isShow:!0})},a.showAdd=function(){a.user=null,a.setState({isShow:!0})},a.deleteUser=function(e){le.a.confirm({title:"\u60a8\u786e\u5b9a".concat(e.username,"\u5220\u9664\u5417"),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(E.a)(v.a.mark(function t(){return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T(e._id);case 2:0===t.sent.status&&(k.a.success("\u5220\u9664".concat(e.username,"\u6210\u529f")),a.getUserList());case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()})},a.state={users:[],roles:[],isShow:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUserList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.roles,c=t.isShow,o=this.user||{},i=r.a.createElement(h.a,{type:"primary",onClick:this.showAdd},"\u521b\u5efa\u7528\u6237");return r.a.createElement(he.a,{title:i},r.a.createElement(Ce.a,{bordered:!0,rowKey:"_id",dataSource:a,columns:this.columns,pagination:{defaultPageSize:Ue,showQuickJumper:!0}}),c&&r.a.createElement(le.a,{title:o._id?"\u4fee\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:c,onOk:this.addOrUpdateUser,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onCancel:function(){e.setState({isShow:!1})}},r.a.createElement(Ot,{setForm:function(t){return e.form=t},roles:n,user:o})))}}]),t}(n.Component),wt=a(153),jt=a.n(wt),xt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).update=function(){a.setState(function(e){return{salesVolume:e.salesVolume.map(function(e){return e+1}),Stock:e.Stock.map(function(e){return e-1})}})},a.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e},{name:"\u5e93\u5b58",type:"bar",data:t}]}},a.state={salesVolume:[5,20,36,10,10,20],Stock:[10,15,20,25,30,10]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.salesVolume,a=e.Stock;return r.a.createElement("div",null,r.a.createElement(he.a,null,r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(he.a,{title:"\u67f1\u72b6\u56fe\u5b9e\u4f8b"},r.a.createElement(jt.a,{option:this.getOption(t,a)})))}}]),t}(n.Component),Ct=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).update=function(){a.setState(function(e){return{salesVolume:e.salesVolume.map(function(e){return e+1}),Stock:e.Stock.map(function(e){return e-1})}})},a.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e},{name:"\u5e93\u5b58",type:"line",data:t}]}},a.state={salesVolume:[5,20,36,10,10,20],Stock:[10,15,20,25,30,10]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.salesVolume,a=e.Stock;return r.a.createElement("div",null,r.a.createElement(he.a,null,r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(he.a,{title:"\u6298\u7ebf\u56fe\u5b9e\u4f8b"},r.a.createElement(jt.a,{option:this.getOption(t,a)})))}}]),t}(n.Component),St=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getOption=function(){return{title:{text:"\u67d0\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},a.getOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort(function(e,t){return e.value-t.value}),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(he.a,{title:"\u997c\u56fe\u4e00"},r.a.createElement(jt.a,{option:this.getOption(),style:{height:300}})),r.a.createElement(he.a,{title:"\u997c\u56fe\u4e8c"},r.a.createElement(jt.a,{option:this.getOption2(),style:{height:300}})))}}]),t}(n.Component),Nt=(a(392),a(128)),It=(a(393),a(70)),_t=(a(1236),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Nt.a,{className:"not-found"},r.a.createElement(It.a,{span:12,className:"left"}),r.a.createElement(It.a,{span:12,className:"right"},r.a.createElement("h1",null,"404"),r.a.createElement("h2",null,"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"),r.a.createElement("div",null,r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.history.replace("/home")}},"\u56de\u5230\u9996\u9875"))))}}]),t}(n.Component)),Tt=(a(1237),ae.a.Footer),Pt=ae.a.Sider,At=ae.a.Content,Mt=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.user;return e&&e._id?r.a.createElement(ae.a,{style:{minHeight:"100%"}},r.a.createElement(Pt,{className:"admin-sider"},r.a.createElement(ie,null)),r.a.createElement(ae.a,null,r.a.createElement(pe,null),r.a.createElement(At,{className:"admin-main"},r.a.createElement(d.d,null,r.a.createElement(d.a,{exact:!0,from:"/",to:"/home"}),r.a.createElement(d.b,{path:"/home",component:xe}),r.a.createElement(d.b,{path:"/category",component:De}),r.a.createElement(d.b,{path:"/product",component:lt}),r.a.createElement(d.b,{path:"/role",component:gt}),r.a.createElement(d.b,{path:"/user",component:kt}),r.a.createElement(d.b,{path:"/charts/bar",component:xt}),r.a.createElement(d.b,{path:"/charts/line",component:Ct}),r.a.createElement(d.b,{path:"/charts/pie",component:St}),r.a.createElement(d.b,{component:_t}))),r.a.createElement(Tt,{className:"admin-footer"},"\u540e\u53f0\u7f51\u7ad9\u5f00\u53d1\uff0c\u4e2a\u4eba\u5f00\u53d1\u5a31\u4e50"))):r.a.createElement(d.a,{to:"/login"})}}]),t}(n.Component),Vt=Object(O.b)(function(e){return{user:e.user}},{})(Mt),Dt=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:te}),r.a.createElement(d.b,{path:"/",component:Vt}),r.a.createElement(d.b,{path:"/error",component:_t})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ut=a(124),Ft=a(545),Lt=G(),Rt=Object(Ut.c)({headerTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u9996\u9875",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"set_header_title":return t.data;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"get_user":return t.user;case"reset_user":return{};default:return e}}}),Wt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ut.d,zt=Object(Ut.e)(Rt,Wt(Object(Ut.a)(Ft.a)));o.a.render(r.a.createElement(O.a,{store:zt},r.a.createElement(Dt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},550:function(e,t,a){e.exports=a(1238)},631:function(e,t,a){},718:function(e,t,a){},728:function(e,t,a){},729:function(e,t,a){},739:function(e,t,a){},927:function(e,t,a){}},[[550,1,2]]]);
//# sourceMappingURL=main.789c53e9.chunk.js.map